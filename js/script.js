!function(){console.info("%cYou can view the project at\nhttps://github.com/edicsonabel/paypalator","font-weight:bold");const startApp=()=>{existLS("data")?drawApp():requestData()},drawApp=()=>{existLS("user")||setLS("user","lang","en","country","us","value",0,"calc",0,"date",dateNow()),drawCountry(),getUser(),userLS.date!==dateNow()&&requestData(!0),drawLanguage(),drawFee(),updateOpts(),drawSymbol(),drawCalculator()},drawLanguage=()=>{optCalculator.classList.add("d-none");let e=userLS.lang;document.getElementsByTagName("html").forEach(t=>t.setAttribute("lang",e)),optReceive.innerHTML=WORDS[e].rp,optSend.innerHTML=WORDS[e].sp,optCalculator.classList.remove("d-none")},drawCalculator=()=>{switch(userLS.calc){case"0":optSend.setAttribute("aria-selected","false"),optSend.classList.remove("active"),optReceive.setAttribute("aria-selected","true"),optReceive.classList.add("active"),sendHTML.classList.remove("active"),receiveHTML.classList.add("active");break;case"1":optReceive.setAttribute("aria-selected","false"),optReceive.classList.remove("active"),optSend.setAttribute("aria-selected","true"),optSend.classList.add("active"),receiveHTML.classList.remove("active"),sendHTML.classList.add("active")}},drawCountry=()=>{getData(),optCountry.classList.add("d-none");let e="";for(let t of dataLS)e+=`<option value="${t.country}">${t.name} (${t.currency})</option>`;optCountry.innerHTML=e,optCountry.classList.remove("d-none")},drawFee=()=>{optFee.classList.add("d-none");let e="",t=getIndex(),a=dataLS[t],n=userLS.lang;for(let t of a.data){let r=t.values;e+=`<optgroup label="${t.section[n]}">`;for(let t of r)e+=`\n        <option value="${t.id}">\n          ${t.perc}% + ${a.symbol} ${pretty(t.fee)} ${t.text[n]?"("+t.text[n]+")":""}\n        </option>`;e+="</optgroup>"}optFee.innerHTML=e,optFee.classList.remove("d-none")},drawSymbol=()=>{let e=getIndex();txtPaypal.classList.add("d-none"),txtSymbol.innerHTML=dataLS[e].symbol,txtPaypal.classList.remove("d-none")},existLS=e=>!!localStorage.getItem(e),requestData=async(e=!1)=>{await fetch("https://cdn.jsdelivr.net/gh/edicsonabel/paypalator/js/data.min.json").catch(e=>console.log(e)).then(e=>e.json()).then(e=>setLS("data",JSON.stringify(e))).then(e?changeUser("date",dateNow()):drawApp)},getUser=()=>{let e=getLS("user");userLS=JSON.parse(`${e}`)},getData=()=>{let e=getLS("data");dataLS=JSON.parse(`${e}`)},getLS=e=>localStorage.getItem(e),pretty=e=>(e=parseFloat(e).toFixed(2),isNaN(e)?0:e),changeOpt=(e,t)=>{e.value=t},setLS=(e,...t)=>{let a=t.length;if(1===a)return localStorage.setItem(e,t);if(a%2!=0)return console.log('wrong format, must be "key", "value"');let n="{";a=t.length;for(let e=0;e<a;e+=2)n+=`"${t[e]}":"${t[e+1]}"`,n+=e+2<a?",":"}";localStorage.setItem(e,n)},resetFee=()=>{changeUser("value",0),drawSymbol()},changeUser=(key,value,reset=!1)=>{getUser(),eval(`userLS.${key} = "${value}"`),setLS("user",JSON.stringify(userLS)),reset&&resetFee(),getUser(),updateOpts(),reset&&drawFee()},updateOpts=()=>{changeOpt(optCountry,userLS.country),changeOpt(optFee,userLS.value),calculate()},calculate=()=>{let e=userLS.lang,t=inputPaypal.value.replace(",",".");isNaN(t)?(receiveHTML.innerHTML=`\n      <strong class='text-center h4 d-block'>\n        ${inputPaypal.value} ${WORDS[e].nan}\n      </strong>`,sendHTML.innerHTML=`\n      <strong class='text-center h4 d-block'>\n        ${inputPaypal.value} ${WORDS[e].nan}\n      </strong>`):(receiveHTML.innerHTML=fnReceive(t),sendHTML.innerHTML=fnSend(t))},fnReceive=e=>{let t=userLS.lang,a=getIndex();e=parseFloat(e);let n=getValues(),r=parseFloat(n.fee),s=parseFloat(n.perc),l=dataLS[a].symbol,o=dataLS[a].currency,c=(e+r)/(1-s/100),d=c*s/100;return c<0&&(c=0,d=0,e=0),`\n      <table class="table">\n        <thead class="primary-color white-text">\n          <tr >\n            <th scope="col">${o}</th>\n            <th scope="col">${s}%</th>\n            <th scope="col">fee</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr >\n            <td>${l} ${pretty(e)}</td>\n            <td>${l} ${pretty(d)}</td>\n            <td>${l} ${pretty(r)}</td>\n          </tr>\n        </tbody>\n      </table>\n      <div class="text-center">\n        <span>\n          <strong class='h4'>${WORDS[t].ts}: ${l} ${pretty(c)} (${o})</strong>\n        </span>\n      </div>`},fnSend=e=>{let t=userLS.lang,a=getIndex();e=parseFloat(e);let n=getValues(),r=parseFloat(n.fee),s=parseFloat(n.perc),l=dataLS[a].symbol,o=dataLS[a].currency,c=e*s/100,d=e-c-r;return d<0&&(d=0,c=0,e=0),`\n      <table class="table">\n        <thead class="primary-color white-text">\n          <tr >\n            <th scope="col">${o}</th>\n            <th scope="col">${s}%</th>\n            <th scope="col">fee</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr >\n            <td>${l} ${pretty(e)}</td>\n            <td>${l} ${pretty(c)}</td>\n            <td>${l} ${pretty(r)}</td>\n          </tr>\n        </tbody>\n      </table>\n      <div class="text-center">\n        <span>\n          <strong class='h4'>${WORDS[t].tr}: ${l} ${pretty(d)} (${o})</strong>\n        </span>\n      </div>`},getValues=()=>{let e=0,t=0,a=parseFloat(userLS.value),n=getIndex(),r=dataLS[n].data;return r.map(n=>n.values.map(n=>n.id===a?t=e:"")?e++:""),r[t].values.filter(e=>e.id===a)[0]},getIndex=()=>{let e=0,t=0,a=userLS.country;return dataLS.map(n=>n.country===a?t=e:e++),t},dateNow=()=>{const e=new Date;let t=e.getDate().toString(),a=(e.getMonth()+1).toString(),n=e.getFullYear().toString();return t=t.length<2?`0${t}`:`${t}`,n+(a=a.length<2?`0${a}`:`${a}`)+t},WORDS={en:{rp:"Receive Payments",sp:"Send Payments",tr:"To receive",ts:"To send",nan:"it's not a number"},es:{rp:"Recibir Pagos",sp:"Enviar Pagos",tr:"Recibir",ts:"Enviar",nan:"no es un nÃºmero"}};let dataLS,userLS,inputPaypal=document.getElementById("quantityPaypal"),receiveHTML=document.getElementById("pills-receive"),sendHTML=document.getElementById("pills-send"),optCalculator=document.getElementById("pills-tab"),optReceive=document.getElementById("pills-receive-tab"),optSend=document.getElementById("pills-send-tab"),optCountry=document.getElementById("optCountry"),optFee=document.getElementById("optFee"),txtSymbol=document.getElementById("txtSymbol"),txtPaypal=document.getElementById("txtPaypal"),langEN=document.getElementById("langEN"),langES=document.getElementById("langES");inputPaypal.addEventListener("keyup",calculate),optCountry.addEventListener("change",()=>changeUser("country",optCountry.value,!0),!1),optFee.addEventListener("change",()=>changeUser("value",optFee.value),!1),optReceive.addEventListener("click",()=>{changeUser("calc",0),drawCalculator()},!1),optSend.addEventListener("click",()=>{changeUser("calc",1),drawCalculator()},!1),langEN.addEventListener("click",()=>{changeUser("lang","en"),drawApp()},!1),langES.addEventListener("click",()=>{changeUser("lang","es"),drawApp()},!1),startApp()}();